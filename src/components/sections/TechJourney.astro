---
import type { WorkExperience } from "../../types";
import TimelineCard from "../common/TimelineCard.astro";

export interface Props {
  journeyTitle: string;
  journeyDesc: string;
  workExperience: WorkExperience[];
  achievements: Record<string, string[]>;
}

const { journeyTitle, journeyDesc, workExperience, achievements } = Astro.props;
---

<section class="py-20 bg-muted">
  <div class="max-w-6xl mx-auto px-6">
    <div class="text-center mb-16 animate-fade-in-up">
      <h2
        class="text-3xl lg:text-4xl font-bold text-primary mb-4"
        id="journeyTitle"
      >
        {journeyTitle}
      </h2>
      <p
        class="text-xl text-muted-foreground max-w-2xl mx-auto"
        id="journeyDesc"
      >
        {journeyDesc}
      </p>
    </div>

    <div class="relative">
      <!-- Timeline Line -->
      <div
        class="absolute left-1/2 transform -translate-x-1/2 w-1 h-full bg-primary/20"
      >
      </div>

      <div class="space-y-16" id="journeyTimeline">
        {
          workExperience.map((job, i) => {
            const year = job.period.split(' - ')[0].split(' ').pop() || job.period;
            const jobAchievements = achievements[job.company] || [];
            const description = jobAchievements.length > 0
              ? jobAchievements.join(' â€¢ ')
              : job.position;
            
            return (
              <div
                class="animate-fade-in-up relative"
                style={`animation-delay: ${i * 0.1}s`}
              >
                <div class="grid lg:grid-cols-[1fr_auto_1fr] gap-8 items-center">
                  {i % 2 === 0 ? (
                    <>
                      {/* Left Side */}
                      <TimelineCard
                        year={year}
                        title={job.position}
                        description={description}
                        tech={job.technologies}
                        align="left"
                      />

                      {/* Timeline Dot */}
                      <div class="flex justify-center items-center relative z-10">
                        <div class="w-6 h-6 bg-primary rounded-full border-[5px] border-background shadow-xl ring-4 ring-primary/20" />
                      </div>

                      {/* Empty Right Side */}
                      <div class="hidden lg:block" />
                    </>
                  ) : (
                    <>
                      {/* Empty Left Side */}
                      <div class="hidden lg:block" />

                      {/* Timeline Dot */}
                      <div class="flex justify-center items-center relative z-10">
                        <div class="w-6 h-6 bg-primary rounded-full border-[5px] border-background shadow-xl ring-4 ring-primary/20" />
                      </div>

                      {/* Right Side */}
                      <TimelineCard
                        year={year}
                        title={job.position}
                        description={description}
                        tech={job.technologies}
                        align="right"
                      />
                    </>
                  )}
                </div>
              </div>
            );
          })
        }
      </div>
    </div>
  </div>
</section>
