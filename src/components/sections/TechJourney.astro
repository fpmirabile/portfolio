---
import type { WorkExperience } from "../../types";
import Timeline from "../common/Timeline.svelte";

interface Props {
  journeyTitle: string;
  journeyDesc: string;
  workExperience: WorkExperience[];
  achievements: Record<string, string[]>;
}

const { journeyTitle, journeyDesc, workExperience, achievements } = Astro.props;

const timelineItems = workExperience.map((job: WorkExperience) => {
  const period = job.period;
  const jobAchievements = achievements[job.company] || [];
  const description =
    jobAchievements.length > 0 ? jobAchievements.join(" â€¢ ") : job.position;
  const isPresent = period.toLowerCase().includes("present");
  const displayPeriod = isPresent
    ? period.split(" - ")[0]
    : period;

  return {
    year: displayPeriod,
    title: job.position,
    description,
    tech: job.technologies,
    status: isPresent ? "Active" : undefined,
  };
});
---

<section class="py-20 bg-muted">
  <div class="max-w-6xl mx-auto px-6">
    <div class="text-center mb-16 animate-fade-in-up">
      <h2
        class="text-3xl lg:text-4xl font-bold text-primary mb-4"
        id="journeyTitle"
      >
        {journeyTitle}
      </h2>
      <p
        class="text-xl text-muted-foreground max-w-2xl mx-auto"
        id="journeyDesc"
      >
        {journeyDesc}
      </p>
    </div>

    <Timeline items={timelineItems} variant="work" client:load />
  </div>
</section>
